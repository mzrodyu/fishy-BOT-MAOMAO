version: '3.8'

services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend
    container_name: meow-backend
    restart: unless-stopped
    ports:
      - "8001:8001"
    volumes:
      - ./data:/app/data
    environment:
      - DATA_DIR=/app/data
      - ADMIN_PASSWORD=${ADMIN_PASSWORD:-admin123}
      - LLM_BASE_URL=${LLM_BASE_URL}
      - LLM_API_KEY=${LLM_API_KEY}
      - LLM_MODEL=${LLM_MODEL:-gemini-2.0-flash}

  bot:
    build:
      context: .
      dockerfile: Dockerfile.bot
    container_name: meow-bot
    restart: unless-stopped
    depends_on:
      - backend
    environment:
      - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN}
      - BACKEND_URL=http://backend:8001
      - BOT_ID=${BOT_ID:-default}
